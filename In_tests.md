### Список потенциально теплонагруженных компонентов плат (если упоминается проверка на нагрев, см сюда):
   - плата контроллера: L1, U5, IC1, U6, Q1, Q2, C6, C7, R8, R12, R13, D2, D5, U4, U7, U8, R9, R10
   - материнская плата: Q1, Q3, D11, D13, D12, U2, R2, F1, F2
   - симисторная плата: U3, U4, Q3, Q5, Q7, Q9, OC2, OC3, OC4, OC5, R12, R13, R16, R17, R20, R21, R24, R25, L1, C11, C12, C18, C19, C21, C22, C24, C25, C27, C28, Q4, Q6, Q8, Q10
   - плата цифровых вх\вых: U5, U7, U9, U6, U8, U10, U11, R22, R53, D9, D11-D19
   - плата аналоговых вх\вых: L1, U4, U6, Q1, Q2, R8, F2, F3, U5
   - плата шаговых двигателей: U5, U9, Q5, Q6, U6, U2G, U2A, U2C, U2D, OC1, Q10, Q11, Q12, Q13
   - плата ДПТ: U4, U2, U5, Q3-Q7, U7, R34, L1, D5, D6, D7, D12, D1
   - плата свето\фотодиодов: U11, R9, D1, D3, D5, D7, U1A, U1B, U1C, U1D
   - плата QR кодов: U2, U4-U8, Q2, Q3, L2, L3, C10, C12, C13, C19, C20, C21, C22, C23, C24, C25, C26, C35, C36

-------------------------------

### Во всех тестах задействованы материнская плата и плата контроллера, дальнейшие отличия в компоновке разделены на 3 группы:
   - Группа 1 - симисторная плата х2, плата аналоговых вх\вых х2
   - Группа 2 - цифровые вх\вых, плата ШД х2, плата QR-кодов х2, плата ДПТ
   - Группа 3 - Группа 1 + Группа 2

**Шаги для подключения каждой из групп:**
0. Всё подключаемые разъёмы питания должны быть обесточены, пока не продекларировано обратное.

Основа
1. Материнская плата: подключить в разъём J26 плюсовой провод питания 24V, а в разъём J27 - минусовой.
2. Плата конроллера: подключить ...

Группа 1
1. Симисторная плата: в разъём J6 подключить питание 230AC (провод до 1.5 кв.мм)
2. В разъёмы J2-J5 попарно (1 клемма - 1 спираль) подключаются спирали печи
3. Повторить шаги 1 и 2 для второй платы, если потребуется
4. Плата аналоговых вх\вых: в разъёмы J7, J8 подключить датчики температуры (полярность неважна)
5. В разъём J4 подключить питание 230AC (провод до 1.5 кв.мм)
6. В разъёмы J5 и J6 подключить вентиляторы (полярность неважна)
7. В разъём J9 подключить датчик тока (полярность неважна), датчик тока в свою очередь повесить на фазный провод, от которого запитана печь
8. В разъём J11 подключить реле, которое расположено перед силовой частью печи
9. Разложить все платы перед собой на столе и ещё раз проверить корректность подключений
10. Позвать ревьюера, чтобы ревьюер бегло проверил подключения на корректность
11. Воткнуть дочерние платы в материнскую плату, начать тест

Группа 2
1. Плата цифровых вх\вых: подключить попарно (1 колодка - 1 спираль) спирали нагрузочного стенда в разъёмы J4-J9
2. В разъём J10 в соответствии с маркировкой на плате подключить провода питания 24V
3. Плата шаговых двигателей: в разъёмы J3-J6 подключить концевые выключатели (расположить плату таким образом, чтобы монтажные отверстия располагались слева, а клеммные колодки сверху). 1 контакт клеммы - GND, 2 - сигнальный, 3 и 4 - +24V, распиновка всех четырёхконтактных разъёмов идентична. 
4. Подключить в разъём J2 шаговые двигатели: расположение платы, как в предыдущем пункте, нумерация слева-направо. 1 - +24V, 2 - EN, 3 - +24V, 4 - DIR, 5 - +24V, 6 - STEP
5. Если требуется вторая плата ШД, повторить для неё шаги 3 и 4
6. Плата QR-кодов: в разъёмы J9 и J10 подключить сканеры QR кодов, (расположить плату таким образом, чтобы монтажные отверстия располагались слева, а клеммные колодки сверху). Нумерация контактов слева-направо. 1 - GND, 2 - TX, 3 - RX, 4 - VCC, у второй колодки точно также. 
7. Плата ДПТ: в разъём J2 подключить в соответствии с маркировкой на плате питающие провода +24V.
8. В разъём J3 подключить первый двигатель постоянного тока, в J4 - второй. Если направление вращение не соответствует ожиданиям, поменять провода в клеммнике местами. 
9. Если необходима для тестирования необходима вторая плата ДПТ, повторить шаги 7 и 8 для неё
10. Разложить все платы перед собой на столе и ещё раз проверить корректность подключений
11. Позвать ревьюера, чтобы ревьюер бегло проверил подключения на корректность
12. Воткнуть дочерние платы в материнскую плату, начать тест


------------------------------

### Сценарий 1: Проверка работы при экстремальных отклонениях напряжения (±25%)

**Прошивки:**  
- Основной контроллер: **init_func** – запускается при подаче питания, после успешной инициализации дочерних модулей меняет цвет светодиода и переходит в основной режим.  
- Дочерние модули: **child_init** + соответствующие функциональные прошивки (в зависимости от типа модуля: **motor_control**, **triac_control**, **sensor_readout**, **led_light_control**, **qr_reader_func**).  
  При подаче питания модули под child_init отвечают 11111111 и устанавливают RTS. После получения подтверждения от всех модулей контроллер init_func переходит в основной режим, функциональные прошивки начинают работу.

**Ожидаемые результаты:**  
- При +30В срабатывают защитные механизмы (предохранители разрывают цепь).  
- При 18В наблюдается пониженная яркость индикаторов (led_light_control), но без повреждений.  
- Проверка нагрева материнской платы (температура ≤40°C, контролируется с помощью sensor_readout или пирометра).

**Шаги:**  
1. Загрузить init_func в контроллер, на все дочерние платы – child_init + их функциональные прошивки.  
2. Установить все дочерние платы в материнскую плату. Подключить ИП 24В, не подавать питание.  
3. Подать питание 24В: init_func запускается, опрашивает модули. Дочерние child_init после инициализации отвечают 11111111, поднимают RTS, затем переходят к функциональным прошивкам.  
4. Установить ИП на 18В. Подать питание. Убедиться, что индикаторы D12 и D14 на материнской плате горят тускло, но стабильно.  
5. Проверить напряжения (вольтметр) и убедиться, что отклонения в пределах норм. sensor_readout может выдать текущие параметры.  
6. Проверить нагрев материнской платы (пирометр), температура ≤40°C.  
7. Отключить питание.  
8. Установить ИП на 30В. Подать питание. Из-за перенапряжения предохранители сработают (предположительно). child_init не смогут корректно инициализироваться или выдадут аварийный код (00000000), RTS не поднимется.  
9. Проверить напряжение вольтметром – отсутствует или аварийно низкое. Функциональные прошивки не запустятся, т.к. нет нормального ответа от child_init.  
10. Проверить нагрев платы материнской (пирометр), температура ≤40°C.  
11. Отключить питание.

---------------------------------  
### Сценарий 2: Проверка устойчивости при колебаниях напряжения (±5%)

**Прошивки:**  
- Основной контроллер: init_func – уже в рабочем режиме.  
- Дочерние: child_init + функциональные (sensor_readout для аналоговых, triac_control для симисторных, motor_control для двигателей и т.д.). Они уже инициализированы с предыдущего включения (или при новом старте аналогично сценарию 1).

**Ожидаемые результаты:**  
- Стабильная работа при 22.8В–25.2В.  
- Нормальная выдача данных от sensor_readout, отсутствие искажений.

**Шаги:**  
1. Все прошивки (init_func на контроллере, child_init + функциональные на модулях) загружены.  
2. Подключить ИП (24В), задать 22.8В. Подать питание. Дочерние модули поднимут RTS после child_init, контроллер init_func подтвердит и перейдёт в рабочий режим.  
3. Измерить напряжения, отклонение ≤5%. sensor_readout корректно выдаёт данные, никаких сбоев.  
4. Плавно переключать напряжение между 22.8В и 25.2В. Проверять стабильность индикаторов (led_light_control) и сигнальных линий (motor_control, triac_control).  
5. Проверить нагрев материнской платы.  
6. Отключить питание.

---------------------------------  
### Сценарий 3: Проверка источников питания при номинальной нагрузке

**Прошивки:**  
- Контроллер: init_func  
- Дочерние: child_init + функциональные (motor_control, triac_control, sensor_readout, led_light_control, qr_reader_func и т.п.)

**Ожидаемые результаты:**  
- При 24В все платы стабильно работают.  
- Напряжения на контрольных точках в норме.  
- Нагрев в норме (контролируется sensor_readout и пирометром).

**Шаги:**  
1. Установить все дочерние платы, подать питание 24В. init_func опрашивает модули, те через child_init после опроса подтверждают готовность (11111111), RTS поднята, запускаются функциональные прошивки.  
2. Проверить напряжения на контрольных точках (вольтметр).  
3. Подключить нагрузки, соответствующие каждой плате. Функциональные прошивки (motor_control, triac_control и др.) работают под нормальной нагрузкой.  
4. Проверить нагрев плат (sensor_readout или пирометр, ≤40°C).  
5. Отключить питание.

---------------------------------  
### Сценарий 4: Проверка логических уровней

**Прошивки:**  
- Контроллер: init_func  
- Дочерние: child_init + соответствующие функциональные (например, motor_control для шаговых двигателей, sensor_readout для входов и т.д.)

**Ожидаемые результаты:**  
- Логические сигналы соответствуют нормам 3.3В/5В, без искажений.

**Шаги:**  
1. Подать 24В, init_func запускается, child_init на модулях отвечают 11111111, RTS взведена, функциональные прошивки активны.  
2. Подключить Анализатор к RS485, RTS, цифровым I/O линиям.  
3. Активировать тестовые сигналы с контроллера (init_func может послать команду motor_control и прочим модулям).  
4. Проверить уровни сигналов Анализатором, отклонения ≤5%.  
5. Отключить питание.

---------------------------------  
### Сценарий 5: Проверка обмена данными

**Прошивки:**  
- Контроллер: init_func  
- Дочерние: child_init + функциональные (например, sensor_readout для передачи данных с датчиков, motor_control для состояний двигателей и т.д.)

**Ожидаемые результаты:**  
- Передаваемые данные по RS485 совпадают с ожидаемыми. Нет задержек >50 мс.

**Шаги:**  
1. Подать 24В. init_func запускается, опрашивает child_init, после успешного опроса модули подтверждают готовность (11111111), функциональные прошивки активны. 
2. Запустить цикл опроса дочерних плат. Контроллер шлёт запросы, модули (через функциональные прошивки) отвечают.  
3. Анализатором убедиться, что полученные пакеты идентичны отправленным.  
4. Измерить время ответа (≤50 мс).  
5. Повторить 100 раз, нет пропусков.  
6. Отключить питание.

---------------------------------  
### Сценарий 6: Проверка защиты от обратной полярности

**Прошивки:**  
- Контроллер: init_func  
- Дочерние: child_init + функциональные

**Ожидаемые результаты:**  
- При обратной полярности защита срабатывает, компоненты не повреждены.

**Шаги:**  
1. Подключить плату к ИП. Установить 24В и подать питание. child_init выдаст 11111111, функциональные прошивки запустятся.  
2. Отключить питание, поменять полярность на ИП. Подать питание. Защита не позволит повредить модули, RTS не поднята, нормальный ответ отсутствует.  
3. Отключить питание, вернуть правильную полярность. Подать питание, убедиться в нормальной работе (11111111 от child_init).

---------------------------------  

### Сценарий 7: Тестирование внезапных отключений

**Прошивки:**  
- Контроллер: `init_func`  
- Дочерние: `child_init` + функциональные

**Ожидаемые результаты:**  
- При внезапном отключении 24В система безопасно останавливается. После повторной подачи питания `init_func` заново инициирует модули, они отвечают `child_init` (11111111), функциональные прошивки возобновляют работу.

**Шаги:**  
1. Подать 24В, все прошивки работают.  
2. В процессе работы отключить 24В. Система останавливается.  
3. **Отключение во время опроса дочерних модулей:**  
   - Подать питание 24В.  
   - Убедиться, что контроллер опрашивает модули через `child_init`.  
   - В момент опроса отключить питание 24В.  
   - Убедиться, что система корректно завершает процессы и при повторной подаче питания опрос модулей возобновляется без сбоев.

4. **Отключение питания на этапе инициализации функциональных модулей:**  
   - Подать питание 24В.  
   - Убедиться, что инициализация модулей началась (`child_init` отвечает 11111111).  
   - Отключить питание 24В до завершения инициализации функциональных модулей.  
   - Повторно подать питание, проверить, что процесс инициализации начинается заново и завершается успешно.

5. **Отключение питания одной из дочерних плат в момент передачи данных:**  
   - Подать питание 24В.  
   - В момент активной передачи данных между дочерней платой и контроллером отключить одну из дочерних плат (извлечь её).  
   - Убедиться, что остальные модули продолжают работать стабильно.  
   - Вернуть плату и проверить корректное завершение её инициализации.

6. **Внезапное отключение питания при обновлении прошивок:**  
   - Подать питание 24В.  
   - Начать обновление прошивок дочерних модулей.  
   - Отключить питание 24В в процессе обновления.  
   - После повторной подачи питания проверить:
     - Контроллер успешно восстанавливается.  
     - Модули с завершённым обновлением работают корректно.  
     - Модули с незавершённым обновлением инициируют повторное обновление.

7. **Многократные короткие отключения питания:**  
   - Подать питание 24В.  
   - В течение 30 секунд несколько раз кратковременно (менее 1 секунды) отключать и подавать питание.  
   - Убедиться, что контроллер и модули не входят в некорректное состояние и возобновляют работу.

8. **Проверка работы после длительного отключения:**  
   - Подать питание 24В.  
   - Убедиться в нормальной работе.  
   - Отключить питание на длительное время (например, 1 час).  
   - Повторно подать питание и проверить, что все модули корректно инициализируются.

9. **Сценарий с падением напряжения:**  
   - Подать питание 24В.  
   - Искусственно создать ситуацию понижения напряжения (например, до 12В).  
   - Убедиться, что система корректно идентифицирует проблему, останавливает модули и сохраняет данные, если это возможно.  
   - Восстановить питание до 24В, проверить, что система корректно восстанавливает работу.

10. **Отключение сети во время выполнения критических операций:**  
    - Подать питание 24В.  
    - Начать выполнение критических операций, таких как запись данных или выполнение команд с жёсткими временными ограничениями.  
    - В момент выполнения отключить питание 24В.  
    - Проверить, что при восстановлении питания система возвращается в стабильное состояние и корректно обрабатывает последствия прерывания. 

---------------------------------  
### Сценарий 8: Механическое тестирование краевых разъёмов

**Прошивки:**  
- init_func + child_init + функциональные (наличие прошивок не критично для механики, но при каждом подаче питания модули инициализируются заново)

**Ожидаемые результаты:**  
- После многократных подключений/отключений дочерних плат разъёмы не повреждены, при подаче питания модули стабильно инициализируются (11111111), функциональные прошивки работают нормально.

**Шаги:**  
1. Отключить питание.  
2. Извлечь дочернюю плату, осмотреть разъёмы, вставить обратно. Повторить 10-20 раз.  
3. Подключить питание. init_func + child_init отработают, RTS поднимется, функциональные прошивки запустятся. Убедиться в нормальной работе.  
4. Повторить для других плат.  
5. Отключить питание.

---------------------------------  
### Сценарий 9: Одновременное включение всех линий RTS

**Прошивки:**  
- Контроллер: init_func  
- Дочерние: child_init + функциональные

**Ожидаемые результаты:**  
- Все дочерние модули одновременно поднимают RTS по команде контроллера. Синхронность в пределах нескольких мс, без коллизий на RS485.

**Шаги:**  
1. Подать 24В. init_func отработал, child_init выдал 11111111, RTS поднята, функциональные прошивки активны.  
2. Подключить Анализатор к линиям RTS.  
3. С контроллера (init_func) послать команду: все дочерние child_init снова поднимают RTS синхронно.  
4. Проверить синхронность сигналов.  
5. По команде контроллера RTS опускается одновременно.  
6. Отключить питание.

---------------------------------  
### Сценарий 10: Проверка помех на сигнальных линиях при работе силовых элементов

**Прошивки:**  
- Контроллер: init_func  
- Дочерние: child_init + motor_control (для двигателей), triac_control (для симисторов), sensor_readout (для аналоговых входов), другие при необходимости.

**Ожидаемые результаты:**  
- Уровни шумов на аналоговых входах (sensor_readout) ≤5% от нормы при включении двигателей (motor_control) и симисторов (triac_control).  
- Нет искажений на цифровых сигналах (RS485).

**Шаги:**  
1. Подать 24В, инициализация (11111111, RTS поднят), функциональные прошивки запущены.  
2. Измерить шумы на аналоговых входах в начальном состоянии (sensor_readout).  
3. Включить двигатели (motor_control) и симисторы (triac_control).  
4. Повторно измерить шум, сравнить с эталоном.  
5. Разместить симисторную плату ближе к аналоговой, повторить измерения, убедиться, что sensor_readout стабильно.  
6. Проверить RS485 на отсутствие искажений.  
7. Отключить питание.

---------------------------------  
### Сценарий 11: Влияние силовых потребителей на показания датчиков

#### Номер группы подключений: 3

**Прошивки:**
**Master:** 
  - init_func
  - master_load_test_02
**Slave:** 
  - child_init 
  - sensor_readout
  - step_motor_load_test
  - triac_load_test
  - digit_load_test
  - analog_load_test
  - dc_motor_load_test

**Ожидаемые результаты:**
- **Измерения тока:**
  - Ожидаемый (указать примерный диапазон в амперах) рост показаний тока при включении нагрузок через step_motor_load_test, dc_motor_load_test, triac_load_test, analog_load_test, digit_load_test
  - Отсутствие скачков и аномалий в показаниях тока.
- **Температурные показатели:**
  - Корректные данные от sensor_readout без колебаний температуры при активации силовых потребителей.

**Шаги:**

1. **Подготовка системы:**
   - Подключить все необходимые компоненты согласно схеме подключения группы 3

2. **Инициализация системы:**
   - Подать питание 24В на систему
   
   - Убедиться, что прошивки инициализируются корректно (RTS поднимается, сигнал 11111111 приходит)

3. **Эталонное измерение:**
   - Считать и зафиксировать эталонные данные с sensor_readout без включенных нагрузок

4. **Тестирование:**
   - Отправить айдишник или порядковый номер в мат плате на следующую за контроллером плату.
   - Смотреть, чтобы данные с датчиков приходили в терминал раз в 10 сек.
   - По завершении теста светодиод быстро мигнёт несколько раз

5. **Дождаться завершения**

6. **Отправить сигнал о нагрузке для следующей платы:** повторять, пока платы не закончатся (платы QR кодов можно игнорировать)

7. **Отключение нагрузок:**
   - Последовательно отключить все нагрузки
   - Сравнить текущие значения с изначальными

8. **Завершение теста:**
   - Отключить питание 24В.
   - Проверить состояние всех компонентов на отсутствие перегрева и повреждений.
   - Зафиксировать результаты тестирования для последующего анализа.

---------------------------------
### Сценарий 12: Тестирование сборки под максимальной нагрузкой

#### Номер группы подключений:

**Прошивки:**
- Master: init_func
- Slave: child_init + step_motor_load_test, triac_load_test, sensor_readout, analog_load_test, digit_load_test, dc_motor_load_test, qr_reader_func

**Ожидаемые результаты:**
- Отсутствие перегрева компонентов материнской и дочерних плат
- Нет оплавления разъёмов, дорожки не перегорели
- Защитные автоматы не отключились
- Ни одна из плат не ушла в ошибку
- Нет белого дыма

**Шаги:**

1. Подготовить оборудование согласно общей инструкции подключения:
   - Выполнить шаги подключения группы 3 (Группа 1 + Группа 2)
   - Залить прошивки по контроллерам

2. Поднять автоматы, ответственные за питание печи и вентиляторов

3. При помощи мультиметра убедиться, что на входных клеммах реле печи присутствует напряжение ±230V, на клемме J6 платы аналоговых вх\вых также проверить наличие сетевого напряжения.

4. Проверить корректность подключений самостоятельно, затем позвать ревьюера для финальной проверки корректности подключений

5. Подключить ПК к UART контроллера по USB для мониторинга данных прошивки init_func (плата контроллера при этом может быть извлечена из материнской платы)

6. Открыть на ПК терминал для записи\чтения команд через UART

7. Светодиод на плате начал мигать красным - ввести в окне терминала кол-во задействованных плат от 1 до 11. Если в ответ пришло то же самое число, всё ок, если иное - вернуться на шаг 5.

8. Ещё раз убедиться, что все платы, включая плату контроллера размещены на материнской плате, подать питание 24В на материнскую плату.

9. Отправить в окно чата "1", если светодиод мигнул жёлтым 3 раза - едем дальше, иначе возврат на шаг 5

10. Ожидание инициализации дочерних плат (светодиод жёлтого цвета плавно загорается и гаснет, макс 60сек)

11. Когда жёлтый светодиод загорится зелёным - первичная инициализация пройдена.

12. Послать в терминал "2". Плата контроллера начнёт отправку команд на загрузку дочерних плат в предельном режиме с интервалом в 1 сек.

13. После завершения тестирования каждая дочерняя плата должна поднять RTS и сообщить о том, что выжила, если выжила.

14. Опустить автоматы, питающий печь и вентиляторы

15. Отключить питание 24V

16. Извлекать платы из материнской платы по одной, начиная с конца (с противоположной от контроллера стороны)

17. Замерять пирометром наиболее теплонагруженные компоненты (см. схему теплонагруженных компонентов для каждой платы)

18. При нагреве свыше 50° обвести компонент на рисунке



